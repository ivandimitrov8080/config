#!/usr/bin/env bash

bg_dir="$(xdg-user-dir "PICTURES")/bg"
img_file="$bg_dir/$(date +%Y-%m-%d).png"
mkdir -p "$bg_dir"

fetch() {
  img_url="$(curl "https://www.bing.com/HPImageArchive.aspx?format=js&idx=0&n=1&mkt=en-US" | jq ".images[0].url" | sed "s/\"//g" | awk '{printf "https://bing.com%s", $1 }')"
  wget -O "$img_file" "$img_url"
}

[ -e "$img_file" ] || fetch

swaybg -i "$img_file"
